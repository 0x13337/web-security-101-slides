<!DOCTYPE html>
<html>
    <head>
        <title>Web Security 101 | William Durand</title>
        <link rel="stylesheet" href="reveal.js/css/reveal.min.css">
        <link rel="stylesheet" href="reveal.js/css/theme/moon.css" id="theme">
        <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
        <link rel="stylesheet" href="css/fix-fontawesome-reveal-js.css">
        <link rel="stylesheet" href="css/custom.css">
        <script>
            document.write('<link rel="stylesheet" href="reveal.js/css/print/' +
                (window.location.search.match(/print-pdf/gi) ? 'pdf' : 'paper') +
                '.css" type="text/css" media="print">'
            );
        </script>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <h1 class="title">Web Security 101</h1>
                    <em>William Durand</em>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # Open Web Application Security Project
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            # OWASP

                            * **Not-for-profit** organization focused on **improving the<br>security**
                            of software;

                            * **Documentation** and **tools** to help learn about security,
                            <br>and protect your applications.

                            <br>
                            <i class="fa-globe"></i> [https://www.owasp.org](https://www.owasp.org)
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            # OWASP Top 10

                            1. Injection
                            2. Broken Authentication and Session Management
                            3. Cross-Site Scripting (XSS)
                            4. Insecure Direct Object References
                            5. Security Misconfiguration
                            6. Sensitive Data Exposure
                            7. Missing Function Level Access Control
                            8. Cross-Site Request Forgery (CSRF)
                            9. Using Components with Known Vulnerabilities
                            10. Unvalidated Redirects and Forwards
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # 1. Injection
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## In A Nutshell

                            * Occurs when an application sends untrusted data to an interpreter

                            * Attacker sends simple text-based attacks that exploit the syntax
                            of the targeted interpreter

                            * Almost any source of data can be an injection vector (`GET`/`POST`
                            parameters, `PATH_INFO`, HTTP headers, uploaded **files**)

                            * Can result in data loss or corruption, lack of accountability,
                            <br>or denial of access
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## SQL Injection

                            Unescaped user input causes the premature end of a SQL query,
                            <br>and allows a malicious query to be executed:

                                $query = 'SELECT * FROM foo WHERE bar = "' . $_GET['bar'] . '"';
                                // ?bar=nope" OR 1 = 1 --
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## I/O Injection

                            Filesystem access combined to unvalidated user input allows
                            attackers to access private files:

                                echo file_get_contents($_GET['file']);
                                // ?file=../private.conf
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Remote Code Execution

                            Unsafe input is dynamically executed:

                                exec('rm -rf upload/' . $_GET['file']);
                                // ?file=*; rm -rf /;
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## How To Prevent Injections?

                            ### Escape, escape, escape!

                            * SQL: **Prepared Statements** (PDO)
                            * Input/Output: `basename()`, `realpath()`
                            * System calls: `shell_escape_args()`
                            * Validate **all** user input
                            * Positive or **white list** input validation
                            * Avoid `eval()` or `exec()` methods
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # 2. Broken Authentication and Session Management
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## In A Nutshell

                            * Attackers use leaks or flaws in the authentication or session
                            management functions (e.g. exposed accounts, passwords, session ids)
                            to impersonate users

                            * May allows some or even all accounts to be attacked. Once successful,
                            the attacker can do anything the victim could do

                            * Privileged accounts are frequentily targeted
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## How To Prevent This?

                            * **Hash** passwords properly (bcrypt/Blowfish please)
                            * **Salt** passwords
                            * Use the [Password Hashing API](http://www.php.net/manual/en/book.password.php) in PHP
                            * Never ever store passwords in clear text!
                            * Don't put session IDs in URLs
                            * Regenerate ids when authentication changes
                            * Allow session IDs to timeout/expire
                            * HTTPS
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## PHP Session Configuration

                                ; Helps mitigate XSS by telling the browser not to expose the cookie to
                                ; client side scripting such as JavaScript
                                session.cookie_httponly = 1

                                ; Prevents session fixation by making sure that PHP only uses cookies for
                                ; sessions and disallow session ID passing as a GET parameter
                                session.use_only_cookies = 1

                                ; Better entropy source
                                ; Evades insufficient entropy vulnerabilities
                                session.entropy_file = "/dev/urandom"
                                ; `session.entropy_length=32` might help against brut-force attacks too!

                                ; Smaller exploitation window for XSS/CSRF/Clickjacking...
                                session.cookie_lifetime = 0

                                ; Ensures session cookies are only sent over secure connections (it requires
                                ; a valid SSL certificate)
                                ; Related to OWASP 2013-A6-Sensitive Data Exposure
                                session.cookie_secure = 1
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # 3. Cross-Site Scripting (XSS)
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## In A Nutshell

                            * The most prevalent web application security flaw

                            * Occurs when an application includes user supplied data in a
                            page sent to the browser without properly validating or escaping
                            that content

                            * Attacker sends text-based attack scripts that exploit the interpreter
                            in the browser

                            * Almost any source of data can be an attack vector, including internal
                            sources such as data from the database, but also URLs, form fields

                            * Can result in session hijacking, malicious scripts execution, website
                            defacement
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## How To Prevent XSS?

                            ### Do not trust anyone!

                            * **Escape** all untrusted data based on the HTML context the data
                            will be place into (`htmlspecialchars()`)
                            * **Whitelist** input validation
                            * Consider **auto-sanitization libraries** ([HTML Purifier](http://htmlpurifier.org/))
                            * Don't even trust admins
                            * Secure your cookies
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Content Security Policy (CSP)

                            Defines the `Content-Security-Policy` HTTP header
                            <br>that allows you to create a **whitelist of sources of
                            trusted content**, and **instructs the browser** to only
                            execute or<br>render resources from those sources.
                            <br>
                            <br>

                                Content-Security-Policy: script-src 'self' https://apis.google.com

                            <img src="images/csp.png" class="no-border" />

                            <i class="fa fa-book"></i> [An Introduction to Content Security Policy](http://www.html5rocks.com/en/tutorials/security/content-security-policy/)
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # 4. Insecure Direct Object References
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## In A Nutshell

                            * Expose a reference to an internal implementation object without
                            verifying authorization

                            * Attacker, who is an authorized system user,
                            changes a parameter value (URL, `GET`/`POST`
                            parameters, cookies) that directly refers to a
                            system object to another object the user is not
                            authorized for

                            * Can compromise all the data that can be
                            referenced by the vulnerable parameter.  Unless
                            object references are unpredictable, it is easy for
                            an attacker to access the available data of that
                            type
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## How To Prevent This?

                            * Use per user or session indirect object references
                            * Always check the user credentials before allowing access to restricted
                            content
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # 5. Security Misconfiguration
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## In A Nutshell

                            * Attacker accesses default accounts, unused pages,
                            unpatched flaws, unprotected files and directories,
                            etc. to gain unauthorized access to or knowledge of the
                            system

                            * Can completely compromise the system without you knowing it.
                            All of your data can be stolen or modified slowly over time.
                            Recovery costs can be expensive!
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## How To Prevent This?

                            * Have a repeatable **hardening process** that makes it fast and easy
                            to deploy another environment that is properly locked down
                            * Have a process for **keeping on top of updates and patches**
                            * strong application architecture that provides **effective**, **secure**
                            separation between components
                            * Consider running scans and doing audits periodically
                            * Disable or fix default accounts
                            * Disable unnecessary services
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # 6. Sensitive Data Exposure
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## In A Nutshell

                            * Failure frequently compromises all data that
                            should have been protected. Typically, this
                            information includes sensitive data such as health
                            records, credentials, personal data, credit cards,
                            etc.

                            * Attackers typically don't break crypto directly.
                            They break something else, such as steal keys, do
                            man-in-the-middle attacks, or steal clear text data
                            off the server, while in transit, or from the
                            user’s browser

                            * Attacker monitors network traffic of your users, maybe
                            in public places (Starbucks), maybe backend connections,
                            maybe inside your network!

                            * Sensitive data deserves extra protection such as
                            encryption at rest or in transit, special precautions
                            when exchanged with the browser
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Insecure Cryptographic Storage

                            * Encrypt sensitive data
                            * Encrypt offsite backups
                            * Use strong standard encryption algorithms
                            * Change your (strong) encryption key regularly
                            * Don't store sensitive data unnecessarily
                            * Ensure passwords are stored with an algorithm
                            specifically designed for password protection
                            * Salt your passwords
                            * Disable autocomplete on forms collecting
                            sensitive data and disable caching for pages that
                            contain sensitive data
                            * Check with a crypto expert
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Insufficient Transport Layer Protection

                            * Require SSL/TLS
                            * At least force the password to be sent encrypted
                            * Ideally any page using the session should have SSL
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## HTTP Strict Transport Security (HSTS)

                            HTTP Strict Transport Security is a security
                            feature that lets a web site tell browsers that it
                            should only be communicated with using HTTPS,
                            instead of using HTTP.
                            <br>
                            <br>

                                Strict-Transport-Security: max-age=expireTime [; includeSubdomains]

                            <br>
                            <i class="fa fa-book"></i> [HTTP Strict Transport Security](https://developer.mozilla.org/en-US/docs/Security/HTTP_Strict_Transport_Security)
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # 7. Missing Function Level Access Control
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## In A Nutshell

                            * Applications do not always protect application functions properly
                            * Misconfiguration
                            * Forgot proper code checks
                            * Attackers access unauthorized functionality by
                            changing the URL or a parameter to a privileged
                            function
                            * Anonymous users can access private functions that aren't protected
                            * Can compromise user accounts, administrative accounts, and unauthorized
                            usage of privileged functionality
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## How To Prevent This?

                            * Consider every page: public or private?
                            * Make sure you check credentials when you serve a
                            page, picture or anything
                            * Make sure checks are in place when authentication
                            is required
                            * **Deny all** by default, explicitly grant access
                            to users or roles
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # 8. Cross-Site Request Forgery (CSRF)
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## In A Nutshell

                            * Attacker creates forged HTTP requests and tricks
                            a victim into submitting them via image tags, XSS,
                            Form POSTs, or numerous other techniques. If the
                            user is authenticated, the attack succeeds

                            * Attackers can create malicious web pages which
                            generate forged requests that are indistinguishable
                            from legitimate ones

                            * Cause victim to change any data the victim is allowed
                            to change, but also to perform any function the victim
                            is authorized to use

                            <br>
                            <i class="fa fa-bookmark"></i> [Facebook CSRF worth USD 5000](http://amolnaik4.blogspot.fr/2012/08/facebook-csrf-worth-usd-5000.html)
                            <br>
                            <i class="fa fa-bookmark"></i> [Does Google Understand CSRF?&nbsp;&nbsp;&nbsp;&nbsp;](http://cryptogasm.com/2012/02/does-google-understand-csrf/)
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## How To Prevent This?

                            * Don't do "things" using the `GET` method
                            * Create one unique token per user (at least once per session)
                            * Include/verify it in every sensitive form
                            * Avoid putting this token in the query string
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # 9. Using Components with Known Vulnerabilities
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## In A Nutshell

                            * Attacker identifies a weak component through
                            scanning or manual analysis. He customizes the
                            exploit as needed and executes the attack

                            * Virtually every application has these issues
                            because most development teams don’t focus on
                            ensuring their components/libraries are up to date.
                            In many cases, the developers don’t even know all
                            the components they are using, never mind their
                            versions. Component dependencies make things even
                            worse.

                            * The impact could range from minimal to complete
                            host takeover and data compromise.
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## How To Prevent This?

                            * Keep components up to date
                            * Identify all components and versions
                            * Monitor security of these components
                            * SensioLabs [Security Advisories Checker](https://security.sensiolabs.org/)
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            # 10. Unvalidated Redirects and Forwards
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## In A Nutshell

                            * Attacker links to unvalidated redirect and tricks
                            victims into clicking it

                            * Victims are more likely to click on it, since the link is to a valid site

                            * Attacker targets unsafe forward to bypass security checks

                            * Such redirects may attempt to install malware or
                            trick victims into disclosing passwords or other
                            sensitive information. Unsafe forwards may allow
                            access control bypass.
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Clickjacking

                            A malicious technique of tricking a Web user into
                            clicking on something different from what the user
                            perceives they are clicking on.

                            Stop Clickjacking with one simple header:

                                X-Frame-Options: DENY|SAMEORIGIN

                            This will cause browsers to refuse requests for
                            framing in that page.  Most websites do not use
                            frames and do not need to be frame-able.
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## How To Prevent This?

                            * Avoid using redirects and forwards
                            * If used, don’t involve user parameters in
                            calculating the destination
                            * If destination parameters can’t be avoided,
                            ensure that the supplied value is valid, and
                            authorized for the user. It is recommended that
                            any such destination parameters be a mapping value,
                            rather than the actual URL or portion of the URL,
                            and that server side code translate this mapping to
                            the target URL.
                        </script>
                    </section>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        # Symfony

                        The NelmioSecurityBundle provides additional<br>security features for your Symfony2 application:

                        <i class="fa fa-github"></i> [nelmio/NelmioSecurityBundle](https://github.com/nelmio/NelmioSecurityBundle)
                    </script>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        # Learn More!

                        <i class="fa fa-book"></i> [OWASP Cheat Sheet Series](https://www.owasp.org/index.php/Cheat_Sheets)
                    </script>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        ## Thank You.

                        ### Questions?

                        <br>
                        <br>
                        <br>
                        <ul class="me">
                            <li>
                                <p><i class="fa fa-globe"></i><a href="http://williamdurand.fr" title="website">williamdurand.fr</a></p>
                            </li>
                            <li>
                                <p><i class="fa fa-github"></i><a href="https://github/willdurand" title="github">github.com/willdurand</a></p>
                            </li>
                            <li>
                                <p><i class="fa fa-twitter"></i><a href="https://twitter.com/couac" title="twitter">twitter.com/couac</a></p>
                            </li>
                        </ul>
                    </script>
                </section>
            </div>
        </div>
        <script src="reveal.js/lib/js/head.min.js"></script>
        <script src="reveal.js/js/reveal.min.js"></script>
        <script>
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                theme: Reveal.getQueryHash().theme,
                transition: Reveal.getQueryHash().transition || 'concave',

                dependencies: [
                    { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    //{ src: 'js/pageNumbers.js' },
                ]
            });
        </script>
    </body>
</html>
